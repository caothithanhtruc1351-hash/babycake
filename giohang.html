<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gi·ªè h√†ng - BabyCake</title>
  <link rel="stylesheet" href="style.css" />
  <script src="script.js"></script>
</head>
<body>
 <header>
  <div class="container header-wrap">
    <div class="logo">
      <a href="index.html">
        <img src="images/Logo.png" alt="BabyCake Logo">
      </a>
    </div>

    <nav>
      <ul>
        <li><a href="index.html" class="active">Trang ch·ªß</a></li>
        <li><a href="sanpham.html">S·∫£n ph·∫©m</a></li>
        <li><a href="gocchiase.html">G√≥c chia s·∫ª</a></li>
        <li><a href="lienhe.html">Li√™n h·ªá</a></li>
      </ul>
    </nav>

    <!-- Gi·ªè h√†ng + Ng∆∞·ªùi d√πng -->
    <div class="header-actions">
      <div class="cart-container">
        <button class="cart-toggle" onclick="toggleCart()">
          üõí <span id="cart-count">0</span>
        </button>
        <div class="cart-box" id="cart-box">
          <h3 class="cart-title">Gi·ªè h√†ng</h3> 
          <ul id="cart-items" class="cart-items"></ul>
          <div class="cart-footer">
            <p class="total-amount" id="total">0ƒë</p>
            <div class="cart-buttons">
              <button class="btn-outline" onclick="viewCart()">XEM GI·ªé H√ÄNG</button>
              <button class="btn-primary" onclick="checkout()">THANH TO√ÅN</button>
            </div>
          </div>
        </div>
      </div>

      <div class="user-info">
        <span id="username-display"></span>
        <span id="welcome-user" style="margin-left: auto; font-weight: bold;"></span>
        <a href="dangnhap.html" id="login-link">
          <img src="https://cdn-icons-png.flaticon.com/512/1144/1144760.png" alt="User Icon" class="user-icon">
        </a>
        <button id="logout-btn" class="hidden">ƒêƒÉng xu·∫•t</button>
      </div>
    </div>
  </div>
</header>

    </div>
  </header>

 <section class="cart-page">
  <div class="container">
    <h2>Gi·ªè h√†ng c·ªßa b·∫°n</h2>
    <ul id="cart-items-page"></ul>
    <p id="total-page" class="total-price">T·ªïng ti·ªÅn: 0ƒë</p>
    <button onclick="clearCart()" class="checkout-btn">X√≥a to√†n b·ªô gi·ªè h√†ng</button>
    <button onclick="checkoutCart()" class="checkout-btn" style="margin-left: 10px; background-color: #28a745;">ƒê·∫∑t H√†ng</button>
    <p id="order-status" style="margin-top: 15px; font-weight: bold; color: #007bff;"></p>
  </div>
</section>
<!-- Form popup nh·∫≠p th√¥ng tin kh√°ch h√†ng -->
<div id="checkout-popup" class="popup-overlay hidden">
  <div class="popup-box">
    <h3>Th√¥ng tin ƒë·∫∑t h√†ng</h3>
    <label for="popup-name">H·ªç v√† t√™n:</label><br>
    <input type="text" id="popup-name" placeholder="Nh·∫≠p h·ªç v√† t√™n"><br><br>
    <label for="popup-phone">S·ªë ƒëi·ªán tho·∫°i:</label><br>
    <input type="tel" id="popup-phone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"><br><br>
    <button onclick="confirmCheckout()" class="checkout-btn">X√°c nh·∫≠n</button>
    <button onclick="closeCheckoutForm()" class="checkout-btn" style="background-color: #ccc;">H·ªßy</button>
    <p id="checkout-result" style="margin-top: 10px; color: green; font-weight: bold;"></p>
  </div>
</div>

  <footer>
    <p>&copy; 2025 BabyCake. All rights reserved.</p>
  </footer>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderCartPage();
  });

  function renderCartPage() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartItems = document.getElementById("cart-items-page");
    const total = document.getElementById("total-page");

    cartItems.innerHTML = "";
    let totalAmount = 0;

    if (cart.length === 0) {
      cartItems.innerHTML = `<p>Hi·ªán ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong gi·ªè h√†ng.</p>`;
      total.textContent = "T·ªïng ti·ªÅn: 0ƒë";
      return;
    }

    cart.forEach(item => {
      const li = document.createElement("li");
      li.innerHTML = `
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
          <img src="${item.image}" alt="${item.name}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 10px;">
          <div style="flex: 1;">
            <strong>${item.name}</strong><br>
            Gi√°: ${item.price.toLocaleString()}ƒë<br>
            <div style="margin-top: 5px;">
              <button onclick="changeQuantity('${item.name}', -1)">-</button>
              <span style="margin: 0 8px;">${item.quantity}</span>
              <button onclick="changeQuantity('${item.name}', 1)">+</button>
              <button onclick="removeItem('${item.name}')" style="background: #ff4d4f; color: white; padding: 4px 8px; border: none; border-radius: 6px; margin-left: 10px;">X√≥a</button>
            </div>
          </div>
        </div>
      `;
      cartItems.appendChild(li);
      totalAmount += item.price * item.quantity;
    });

    total.textContent = `T·ªïng ti·ªÅn: ${totalAmount.toLocaleString()}ƒë`;
  }

  window.changeQuantity = function(name, change) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const item = cart.find(i => i.name === name);

    if (item) {
      item.quantity += change;
      if (item.quantity <= 0) {
        cart = cart.filter(i => i.name !== name);
      }
    }

    localStorage.setItem("cart", JSON.stringify(cart));
    renderCartPage();
    if (typeof updateCartUI === "function") updateCartUI();
  };

  window.removeItem = function(name) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart = cart.filter(i => i.name !== name);
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCartPage();
    if (typeof updateCartUI === "function") updateCartUI();
  };

  window.clearCart = function() {
    localStorage.removeItem("cart");
    renderCartPage();
    if (typeof updateCartUI === "function") updateCartUI();
  };

  // Hi·ªÉn th·ªã form nh·∫≠p th√¥ng tin ƒë·∫∑t h√†ng
  window.checkoutCart = function () {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    if (cart.length === 0) {
      alert("Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng.");
    } else {
      document.getElementById("checkout-popup").classList.remove("hidden");
    }
  };

  // X√°c nh·∫≠n ƒë·∫∑t h√†ng
  function confirmCheckout() {
    const name = document.getElementById("popup-name").value.trim();
    const phone = document.getElementById("popup-phone").value.trim();
    const result = document.getElementById("checkout-result");

    if (!name || !phone) {
      alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß h·ªç t√™n v√† s·ªë ƒëi·ªán tho·∫°i.");
      return;
    }

    result.textContent = `üéâ C·∫£m ∆°n ${name}, ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n qua s·ªë ${phone} ƒë·ªÉ x√°c nh·∫≠n ƒë∆°n h√†ng.`;

    localStorage.removeItem("cart");
    renderCartPage();
    if (typeof updateCartUI === "function") updateCartUI();

    setTimeout(() => {
      closeCheckoutForm();
    }, 3000);
  }

  // ƒê√≥ng form popup
  function closeCheckoutForm() {
    document.getElementById("checkout-popup").classList.add("hidden");
    document.getElementById("checkout-result").textContent = "";
    document.getElementById("popup-name").value = "";
    document.getElementById("popup-phone").value = "";
  }

  // G·∫Øn c√°c h√†m popup v√†o window ƒë·ªÉ HTML c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c
  window.confirmCheckout = confirmCheckout;
  window.closeCheckoutForm = closeCheckoutForm;

  // G·ªçi l·∫°i n·∫øu d√πng icon gi·ªè h√†ng tr√™n header
  if (typeof updateCartUI === 'function') updateCartUI();
</script>


</body>
</html>
